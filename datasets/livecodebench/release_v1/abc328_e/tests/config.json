{
  "question_title": "Modulo MST",
  "question_content": "You are given a weighted simple connected undirected graph with N vertices and M edges, where vertices are numbered 1 to N, and edges are numbered 1 to M. Additionally, a positive integer K is given.\nEdge i\\ (1\\leq i\\leq M) connects vertices u_i and v_i and has a weight of w_i.\nFor a spanning tree T of this graph, the cost of T is defined as the sum, modulo K, of the weights of the edges in T.\nFind the minimum cost of a spanning tree of this graph.\n\nInput\n\nThe input is given from Standard Input in the following format:\nN M K\nu_1 v_1 w_1\nu_2 v_2 w_2\n\\vdots\nu_M v_M w_M\n\nOutput\n\nPrint the answer.\n\nConstraints\n\n\n- 2\\leq N\\leq8\n- N-1\\leq M\\leq\\dfrac{N(N-1)}2\n- 1\\leq K\\leq10^{15}\n- 1\\leq u_i\\lt v_i\\leq N\\ (1\\leq i\\leq M)\n- 0\\leq w_i\\lt K\\ (1\\leq i\\leq M)\n- The given graph is simple and connected.\n- All input values are integers.\n\nSample Input 1\n\n5 6 328\n1 2 99\n1 3 102\n2 3 86\n2 4 94\n2 5 95\n3 4 81\n\nSample Output 1\n\n33\n\nThe given graph is shown below:\n\nThe cost of the spanning tree containing edges 1,3,5,6 is (99+86+81+95)\\bmod{328}=361\\bmod{328}=33.\nThe cost of every spanning tree of this graph is at least 33, so print 33.\n\nSample Input 2\n\n6 5 998244353\n1 2 337361568\n1 6 450343304\n2 3 61477244\n2 5 745383438\n4 5 727360840\n\nSample Output 2\n\n325437688\n\nPrint the cost of the only spanning tree of this graph, which is  325437688.\n\nSample Input 3\n\n8 28 936294041850197\n1 2 473294720906780\n1 3 743030800139244\n1 4 709363019414774\n1 5 383643612490312\n1 6 557102781022861\n1 7 623179288538138\n1 8 739618599410809\n2 3 857687812294404\n2 4 893923168139714\n2 5 581822471860662\n2 6 740549363586558\n2 7 307226438833222\n2 8 447399029952998\n3 4 636318083622768\n3 5 44548707643622\n3 6 307262781240755\n3 7 12070267388230\n3 8 700247263184082\n4 5 560567890325333\n4 6 704726113717147\n4 7 588263818615687\n4 8 549007536393172\n5 6 779230871080408\n5 7 825982583786498\n5 8 713928998174272\n6 7 751331074538826\n6 8 449873635430228\n7 8 11298381761479\n\nSample Output 3\n\n11360716373\n\nNote that the input and the answer may not fit into a 32\\operatorname{bit} integer.",
  "platform": "atcoder",
  "question_id": "abc328_e",
  "contest_id": "abc328",
  "contest_date": "2023-11-11T00:00:00",
  "starter_code": "",
  "difficulty": "hard",
  "public_test_cases": "[{\"input\": \"5 6 328\\n1 2 99\\n1 3 102\\n2 3 86\\n2 4 94\\n2 5 95\\n3 4 81\\n\", \"output\": \"33\\n\", \"testtype\": \"stdin\"}, {\"input\": \"6 5 998244353\\n1 2 337361568\\n1 6 450343304\\n2 3 61477244\\n2 5 745383438\\n4 5 727360840\\n\", \"output\": \"325437688\\n\", \"testtype\": \"stdin\"}, {\"input\": \"8 28 936294041850197\\n1 2 473294720906780\\n1 3 743030800139244\\n1 4 709363019414774\\n1 5 383643612490312\\n1 6 557102781022861\\n1 7 623179288538138\\n1 8 739618599410809\\n2 3 857687812294404\\n2 4 893923168139714\\n2 5 581822471860662\\n2 6 740549363586558\\n2 7 307226438833222\\n2 8 447399029952998\\n3 4 636318083622768\\n3 5 44548707643622\\n3 6 307262781240755\\n3 7 12070267388230\\n3 8 700247263184082\\n4 5 560567890325333\\n4 6 704726113717147\\n4 7 588263818615687\\n4 8 549007536393172\\n5 6 779230871080408\\n5 7 825982583786498\\n5 8 713928998174272\\n6 7 751331074538826\\n6 8 449873635430228\\n7 8 11298381761479\\n\", \"output\": \"11360716373\\n\", \"testtype\": \"stdin\"}]",
  "private_test_cases": "eJyVl02OXUUMhRkwZQ9Xb4YUofJPlW1WgkSYkUEmTaR0BgghsQjYL59v3RZSv0Y8okRJ6laV7eNzjqv/+Pqvb7/56vz1w41//Pjb7ePTpy/Pt++Pmx5yqFfNKs2MLFnvn1g6UmJYWNmqWPn+6fbuuP3y5fk69tbX5w+fn59//fShv39+/vnj0+33d8erUDVK57QSTofFDjVVh1bJHFxa9jrWm58fCWbpQVVD00d47mCaNYf51BlK8q+Dvfn5ocqscoZ4zDlWXpXpkLlKyqexfFfZm5//K5h1c6aWhyxLTa2OxWoBKG1Z7tkodXzRUSJOt8yHvg7vwnGTTP6u+Xh0nWssWzJFXRYHtcOb1zTtts6asuO7ORlkDrc16q58NRmL382Ih+PbIdJ8JYvpIL52fClzn2AwyOzisE9Ik9BbQ+cFE3tcanoNcLmDBPD4pmQ2Mh5MKUnoCMlYtAD9iC/aT6SDUFWRM4eZqHYCcbBxDjhpNN86hh/rsPIEKs7CcvMuKY8ZVJkgrcuhSR+fB3BZF++LphmkDnbCukxuoM8jhTsni5EirTSU7WsXv6JyIHUxm5f8iB5BxWOmmnFDLyYJlS7hNoCrE+JAT5mqjbkvk7t2wuGExYOiTwQexG4eUXOhNkhCBuNEhOxhpwTx6F00yRpQsxrIUtmOQt8/rcaTVJ2qUZ0vlz4NJDoRv9qCC+G9kZKwNydvlbYe6ZpWL8JPXRM4fWkjt46VcCMsEc1ojliHUTICJzJAsdanaXBjJNTtY8pmXV+JnqakrTnUN8YTVBCLeRjXWl9JGDNd6kh2zNmZG/1FiWtiWgJ1d9OSgCv7fjgpFzV05UiUnoCt9y5GkhUCxR80lUTUh40AVRwaiGRkR5oHjIhozVgLY4OGpsMdvpJor/nJy0DjQ6MbEXY1kWppHjOi9bahgFQwdRX9oYLaiCugzQmWkDt6sdGlfRarhuuEFrqV0osDaiMYqKibAyxxrcpUqTF2w1xpGUAm4snatBDBIB39g5mk7n5xjUAVq4VR+imeYEyYsdXwGlg4r4bRqVBoqoN+XnPSmnbIdPjow9uKKRH1tY2szrE1CrLCRugLMXsatUazIcT+2lIb8WaAFIiZg1w44+GSvaA6SkLlc+04wBvkDHMHDrHNBUtAhiuAA8LkJj7sCcDBg1v2uaXUJopjUTw9ly1weI8lFzQg8nxNqoDT0fT/H5RqnFELOoYB5i8MQPFIEXUooa75MXMFQJAAqOuVOR45YwzBWXNPcJqI1xW9pdkjr0GHHyIJmAoY1exrVrQIcbwOzvxfF3cdWXMaynjk2OSlBwJ1F3MFz8zNC24HWEWjqyvYjOb/+G6C0ag5x8VJXCARd5urhW4GQdG2FroV/Y7obgsGBwEC+l06FsOe1lqwhXR2/3tk4ttwaJzo+FkKly/YzbgcEi9uyGhoPySXbIs8aYaqIHMW5kDDNyGFoD0KUSi0nFvZreoWCUzjHbdpZtXeCH94keAeW0mwhsgCSJ3a3FxB1hTXswCbls1HmtzvGLSucvawpS1M1OjBUgTPO1ZJ05zsHn1rdZTGlo4V4lrkcWVk3RO0TqVZsdvlPVZ4X1Fju9tlxsCWC3fGm0Jsg7maPRgBzkYnfTsQKoZ7igU4s/mawIH9cGkams2mwFklVcuYPTn6nt1JRicPFey7bXrohh3m96AMiJHrFCN2znuOib40rMfdZmqbu/B6xVf488+zvKlKj7JfqFsRBOx+VTHMvN2zzcpPzvTFEpcRcCPKbgdzNl8q4RlnPQLjLKe2Gr2JCpK4L7IYl3tipdVeAngrNoFXOwYGWd4/DNjmOTTDIvslxOUxXswKNaF7lMrzI7dyFhMCKUrrlqfo5tu0nnYwk2C8kTaFG9XsckrZGVtj1iViSkxfXHhcCmAmYSwtdMR4RzgmLZqDzP/+Y8tPf373N/GyDZs=",
  "metadata": "{}"
}